{"version":3,"file":"js/931.f4c31d90.js","mappings":"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","sources":["webpack://click-buy-frontend/./src/apis/carts.js","webpack://click-buy-frontend/./src/views/ProductView.vue","webpack://click-buy-frontend/./src/views/ProductView.vue?f743"],"sourcesContent":["import { apiHelper } from './../utils/helpers'\r\nconst getToken = () => localStorage.getItem('token')\r\n\r\nexport default {\r\n  addToCart(productId, amount) {\r\n    const data = {\r\n      productId,\r\n      amount\r\n    }\r\n    return apiHelper.post('/carts/add', data, {\r\n      headers: { Authorization: `Bearer ${getToken()}` }\r\n    })\r\n  },\r\n  getCart() {\r\n    return apiHelper.get('/carts', {\r\n      headers: { Authorization: `Bearer ${getToken()}` }\r\n    })\r\n  },\r\n  buyProducts(carts) {\r\n    return apiHelper.put('/carts/buy', { carts: [...carts] }, {\r\n      headers: { Authorization: `Bearer ${getToken()}` }\r\n    })\r\n  }\r\n}","<template>\r\n  <div class=\"product-section\">\r\n    <div class=\"product-img\">\r\n      <img :src=\"product.image\" alt=\"\" class=\"img\" />\r\n    </div>\r\n    <div class=\"product-detail\">\r\n      <span class=\"product-name\">{{ product.name }}</span>\r\n      <div class=\"product-price\">\r\n        <span>${{ product.price }}</span>\r\n      </div>\r\n      <template v-if=\"role === 'buyer'\">\r\n      <div class=\"amount-group\">\r\n        <span class=\"amount-label\">數量</span>\r\n        <table class=\"mx-3\">\r\n          <tr>\r\n            <td>\r\n              <span class=\"minus-btn\" @click.prevent.stop=\"minusAmount\">-</span>\r\n            </td>\r\n            <td><input type=\"text\" class=\"amount-input\" v-model=\"amount\" /></td>\r\n            <td>\r\n              <span class=\"plus-btn\" @click.prevent.stop=\"plusAmount\">+</span>\r\n            </td>\r\n          </tr>\r\n        </table>\r\n        <span class=\"rest-amount-label\">還剩下{{ product.restAmount }}件</span>\r\n      </div>\r\n      </template>\r\n      <button\r\n        class=\"btn btn-primary add-to-cart mt-5\"\r\n        @click.prevent.stop=\"addToCart\"\r\n        v-if=\"role === 'buyer'\"\r\n      >\r\n        加入購物車\r\n      </button>\r\n    </div>\r\n    \r\n  </div>\r\n  \r\n  <div class=\"shop-section\">\r\n    <div>\r\n      <div class=\"shop-logo\">\r\n        <img :src=\"shop.logo\" alt=\"\" />\r\n      </div>\r\n      <div class=\"shop-info\">\r\n        {{ shop.name }}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { onMounted, ref } from \"vue\";\r\nimport { useRoute } from \"vue-router\";\r\nimport { Toast } from \"../utils/helpers\";\r\nimport productsAPI from \"./../apis/products\";\r\nimport cartsAPI from \"./../apis/carts\";\r\nimport { computed } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\n\r\nexport default {\r\n  setup() {\r\n    const product = ref({});\r\n    const shop = ref({});\r\n    const amount = ref(1);\r\n    const route = useRoute();\r\n    const productId = route.params.productId;\r\n    const store = useStore();\r\n\r\n    async function fetchProducts() {\r\n      try {\r\n        const response = await productsAPI.getProduct(productId);\r\n        product.value = response.data.data.product;\r\n        shop.value = response.data.data.product.Shop;\r\n      } catch (err) {\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"無法取得商品資料，請稍後再試\",\r\n        });\r\n      }\r\n    }\r\n\r\n    const addToCart = async () => {\r\n      try {\r\n        await cartsAPI.addToCart(productId, amount);\r\n\r\n        Toast.fire({\r\n          icon: \"success\",\r\n          title: \"成功加入購物車\",\r\n        });\r\n      } catch (err) {\r\n        Toast.fire({\r\n          icon: \"error\",\r\n          title: \"加入購物車失敗，請稍後再試\",\r\n        });\r\n      }\r\n    };\r\n\r\n    const plusAmount = () => {\r\n      if (product.value.restAmount > amount.value) {\r\n        amount.value = Number(amount.value) + 1;\r\n      }\r\n    };\r\n\r\n    const minusAmount = () => {\r\n      if (amount.value > 1) {\r\n        amount.value = Number(amount.value) - 1;\r\n      }\r\n    };\r\n\r\n    onMounted(() => {\r\n      fetchProducts();\r\n    });\r\n\r\n    return {\r\n      product,\r\n      shop,\r\n      addToCart,\r\n      amount,\r\n      plusAmount,\r\n      minusAmount,\r\n      role: computed(() => store.state.currentUser.role),\r\n    };\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.product-section {\r\n  height: 842px;\r\n  background: white;\r\n  margin-top: 40px;\r\n  display: flex;\r\n}\r\n.shop-section {\r\n  height: 160px;\r\n  padding: 10px;\r\n  background: white;\r\n  margin: 15px 0;\r\n}\r\n.product-img {\r\n  padding: 10px;\r\n  position: relative;\r\n  flex: 1;\r\n}\r\n.product-detail {\r\n  padding: 10px 30px;\r\n  flex: 1;\r\n}\r\n.img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n  object-position: 50% 50%;\r\n}\r\n.product-name {\r\n  font-size: 30px;\r\n}\r\n.product-price {\r\n  background: #fafafa;\r\n  margin-top: 50px;\r\n  height: 70px;\r\n  padding: 10px;\r\n}\r\n.product-price span {\r\n  font-size: 36px;\r\n  color: #d0011b;\r\n}\r\n.add-to-cart {\r\n  display: block;\r\n}\r\ntd,\r\ntr {\r\n  border: 1px solid #eaeaeaff;\r\n}\r\n.amount-input {\r\n  width: 50px;\r\n  border: none;\r\n  text-align: center;\r\n}\r\n.plus-btn,\r\n.minus-btn {\r\n  display: inline-block;\r\n  font-weight: bold;\r\n  font-size: 20px;\r\n  text-align: center;\r\n  width: 25px;\r\n  cursor: pointer;\r\n}\r\n.amount-label {\r\n  font-size: 20px;\r\n}\r\n.amount-group {\r\n  display: flex;\r\n  margin-top: 80px;\r\n  align-items: center;\r\n}\r\n.rest-amount-label {\r\n  color: rgb(184, 183, 183);\r\n}\r\n</style>","import { render } from \"./ProductView.vue?vue&type=template&id=515277f1&scoped=true\"\nimport script from \"./ProductView.vue?vue&type=script&lang=js\"\nexport * from \"./ProductView.vue?vue&type=script&lang=js\"\n\nimport \"./ProductView.vue?vue&type=style&index=0&id=515277f1&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-515277f1\"]])\n\nexport default __exports__"],"names":["getToken","localStorage","getItem","addToCart","productId","amount","data","apiHelper","post","headers","Authorization","getCart","get","buyProducts","carts","put","class","_createElementVNode","_hoisted_1","_hoisted_2","src","$setup","product","image","alt","_hoisted_4","_hoisted_5","_toDisplayString","name","_hoisted_6","price","role","_createElementBlock","_hoisted_7","_hoisted_8","_hoisted_9","onClick","_cache","_withModifiers","args","minusAmount","type","$event","plusAmount","_hoisted_10","restAmount","_hoisted_11","_hoisted_12","shop","logo","_hoisted_14","setup","ref","route","useRoute","params","store","useStore","async","fetchProducts","response","productsAPI","getProduct","value","Shop","err","Toast","fire","icon","title","cartsAPI","Number","onMounted","computed","state","currentUser","__exports__","render"],"sourceRoot":""}