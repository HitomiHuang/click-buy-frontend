(function(){"use strict";var e={9655:function(e,t,r){var n=r(6163);const o=()=>localStorage.getItem("token");t.Z={getProducts(){return n.l.get("/products",{headers:{Authorization:`Bearer ${o()}`}})},getProduct(e){return n.l.get(`/products/${e}`,{headers:{Authorization:`Bearer ${o()}`}})},searchProducts(e){return n.l.post("/products/search",e,{headers:{Authorization:`Bearer ${o()}`}})},getProductsByShop(){return n.l.get("/products/seller",{headers:{Authorization:`Bearer ${o()}`}})},addProduct(e){return n.l.post("/products/add",e,{headers:{Authorization:`Bearer ${o()}`}})},editProduct(e){return n.l.put("/products/edit",e,{headers:{Authorization:`Bearer ${o()}`}})}}},9046:function(e,t,r){var n=r(9963),o=r(6252);const a={class:"wrapper"};function s(e,t,r,n,s,c){const u=(0,o.up)("HeaderTop"),i=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(u,{inputText:n.searchText,"onUpdate:inputText":t[0]||(t[0]=e=>n.searchText=e),onSearch:n.searchProducts},null,8,["inputText","onSearch"]),(0,o._)("div",a,[(0,o.Wm)(i)])],64)}r(7658),r(8877);var c=r(3577);const u=e=>((0,o.dD)("data-v-f1b47e8a"),e=e(),(0,o.Cn)(),e),i={class:"top"},l={class:"wrapper"},d={class:"nav-items left"},p=u((()=>(0,o._)("div",{class:"line"},null,-1))),f=u((()=>(0,o._)("a",{href:"#"},"追蹤我們",-1))),h={class:"nav-items right"},m=u((()=>(0,o._)("a",{href:"#"},"幫助中心",-1))),v=u((()=>(0,o._)("a",{href:"#",class:"nav-item"},"註冊",-1))),g=u((()=>(0,o._)("div",{class:"line"},null,-1))),b=u((()=>(0,o._)("div",{class:"line"},null,-1))),y={href:"#"},w=["src"],_=u((()=>(0,o._)("div",{class:"line"},null,-1))),k={class:"search-block"},A={class:"search-bar"},C=u((()=>(0,o._)("i",{class:"fa-solid fa-magnifying-glass d-block"},null,-1))),x=[C],P={key:0,class:"cart"},U=u((()=>(0,o._)("i",{class:"fa-solid fa-cart-shopping fa-xl d-block"},null,-1)));function S(e,t,r,a,s,u){const C=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("header",i,[(0,o._)("div",l,[(0,o._)("nav",null,[(0,o._)("div",d,["seller"===a.role?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Wm)(C,{to:{name:"seller",params:{shopId:a.shopId}}},{default:(0,o.w5)((()=>[(0,o.Uk)("賣家中心")])),_:1},8,["to"]),p],64)):(0,o.kq)("",!0),f]),(0,o._)("div",h,[m,a.isAuthenticated?((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[b,(0,o._)("a",y,[(0,o._)("img",{src:a.userImage,alt:""},null,8,w),(0,o._)("span",null,(0,c.zw)(a.userName)+", 你好",1)]),_,(0,o._)("a",{href:"#",onClick:t[0]||(t[0]=(...e)=>a.logout&&a.logout(...e))},"登出")],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[v,g,(0,o.Wm)(C,{to:"/login"},{default:(0,o.w5)((()=>[(0,o.Uk)("登入")])),_:1})],64))])]),(0,o._)("div",k,[(0,o.Wm)(C,{to:"/products",class:"logo"}),(0,o._)("div",A,[(0,o.wy)((0,o._)("input",{type:"text",class:"search-input",placeholder:"請輸入關鍵字","onUpdate:modelValue":t[1]||(t[1]=e=>a.keyword=e)},null,512),[[n.nr,a.keyword]]),(0,o._)("button",{class:"btn btn-primary search-btn",onClick:t[2]||(t[2]=(0,n.iM)(((...e)=>a.searchProducts&&a.searchProducts(...e)),["prevent","stop"]))},x)]),"buyer"===a.role?((0,o.wg)(),(0,o.iD)("div",P,[(0,o.Wm)(C,{to:"/cart"},{default:(0,o.w5)((()=>[U])),_:1})])):(0,o.kq)("",!0)])])])}var T=r(3907),I=r(2201),O={props:{inputText:{type:String,default:""}},emits:["update:inputText","search"],setup(e,{emit:t}){const r=(0,T.oR)(),n=(0,I.tv)(),a=(0,o.Fl)({get:()=>e.inputText,set:e=>t("update:inputText",e)}),s=()=>{t("search")},c=()=>{localStorage.removeItem("token"),n.push({path:"/login"})};return{keyword:a,searchProducts:s,logout:c,userImage:(0,o.Fl)((()=>r.state.currentUser.avatar)),userName:(0,o.Fl)((()=>r.state.currentUser.name)),role:(0,o.Fl)((()=>r.state.currentUser.role)),shopId:(0,o.Fl)((()=>r.state.currentUser.shopId)),isAuthenticated:(0,o.Fl)((()=>r.state.isAuthenticated))}}},B=r(3744);const E=(0,B.Z)(O,[["render",S],["__scopeId","data-v-f1b47e8a"]]);var F=E,j=r(2262),D={name:"App",components:{HeaderTop:F},setup(){const e=(0,j.iH)(""),t=(0,I.tv)(),r=()=>{t.push({path:"/search",query:{keyword:e.value}})};return{searchText:e,searchProducts:r}}};const H=(0,B.Z)(D,[["render",s]]);var z=H;function N(e,t){return(0,o.wg)(),(0,o.iD)("h1")}const $={},q=(0,B.Z)($,[["render",N]]);var L=q,M=r(6163);const Z=()=>localStorage.getItem("token");var W={login({account:e,password:t}){return M.l.post("/login",{account:e,password:t})},get({userId:e}){return M.l.get(`/users/${e}`,{headers:{Authorization:`Bearer ${Z()}`}})},getCurrentUser(){return M.l.get("/get_current_user",{headers:{Authorization:`Bearer ${Z()}`}})}};const Y={class:"container py-5"},V=["onSubmit"],R=(0,o._)("div",{class:"text-center mb-4"},[(0,o._)("h1",{class:"h3 mb-3 font-weight-normal"},"Sign In")],-1),K={class:"form-label-group mb-2"},G=(0,o._)("label",{for:"account"},"email",-1),J={class:"form-label-group mb-3"},Q=(0,o._)("label",{for:"password"},"Password",-1),X=["disable"];var ee={__name:"LoginView",setup(e){const t=(0,j.iH)(""),r=(0,j.iH)(""),a=(0,j.iH)(!1),s=(0,I.tv)(),c=(0,T.oR)();async function u(){try{if(!t.value?.trim()||!r.value?.trim())return void M.F.fire({icon:"warning",title:"請填入 account 和 password"});a.value=!0;const e=await W.login({account:t.value,password:r.value}),{data:n,status:o}=e.data;if("success"!==o)throw new Error(o);localStorage.setItem("token",n.token),console.log(n.user),c.commit("setCurrentUser",n.user),s.push("/products")}catch(e){r.value="",M.F.fire({icon:"warning",title:"請確認您輸入了正確的帳號密碼"}),a.value=!1}}return(e,s)=>((0,o.wg)(),(0,o.iD)("div",Y,[(0,o._)("form",{class:"w-100",onSubmit:(0,n.iM)(u,["prevent","stop"])},[R,(0,o._)("div",K,[G,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>t.value=e),id:"account",name:"account",type:"account",class:"form-control",placeholder:"Account",autocomplete:"username",required:"",autofocus:""},null,512),[[n.nr,t.value]])]),(0,o._)("div",J,[Q,(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>r.value=e),id:"password",name:"password",type:"password",class:"form-control",placeholder:"Password",autocomplete:"current-password",required:""},null,512),[[n.nr,r.value]])]),(0,o._)("button",{class:"btn btn-lg btn-primary btn-block mb-5",type:"submit",disable:a.value}," Submit ",8,X)],40,V)]))}};const te=ee;var re=te;const ne={class:"card-wrapper"},oe=["src"],ae={class:"card-body"},se={class:"product-name"},ce={class:"card-text"},ue=(0,o._)("div",{class:"product-discount"},null,-1),ie={class:"product-price"},le={class:"card-text price"},de=(0,o._)("span",{class:"money"},"$",-1);function pe(e,t,r,n,a,s){const u=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",ne,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.products,(e=>((0,o.wg)(),(0,o.j4)(u,{key:e.id,class:"card",to:{name:"product",params:{productId:e.id}}},{default:(0,o.w5)((()=>[(0,o._)("img",{src:e.image,class:"card-image",alt:""},null,8,oe),(0,o._)("div",ae,[(0,o._)("div",se,[(0,o._)("span",ce,(0,c.zw)(e.name),1)]),ue,(0,o._)("div",ie,[(0,o._)("span",le,[de,(0,o.Uk)((0,c.zw)(e.price),1)])])])])),_:2},1032,["to"])))),128))])}var fe=r(9655),he={setup(){const e=(0,j.iH)([]);async function t(){try{const t=await fe.Z.getProducts();e.value=t.data.data.products}catch(t){M.F.fire({icon:"error",title:"無法取得商品資料，請稍後再試"})}}return(0,o.bv)(t),{products:e}}};const me=(0,B.Z)(he,[["render",pe]]);var ve=me,ge=(0,T.MT)({state:{currentUser:{id:-1,name:"",avatar:"",role:"",shopId:-1},isAuthenticated:!1},getters:{},mutations:{setCurrentUser(e,t){e.currentUser={...e.currentUser,...t},e.isAuthenticated=!0}},actions:{async fetchCurrentUser({commit:e}){try{const t=await W.getCurrentUser(),{id:r,name:n,avatar:o,role:a,shopId:s}=t.data.data;e("setCurrentUser",{id:r,name:n,avatar:o,role:a,shopId:s})}catch(t){console.error(t.message)}}},modules:{}});const be=[{path:"/",name:"root",redirect:"/login"},{path:"/login",name:"login",component:re},{path:"/products/:productId",name:"product",component:()=>r.e(931).then(r.bind(r,3931))},{path:"/products",name:"products",component:ve},{path:"/search",name:"search",component:()=>r.e(462).then(r.bind(r,1462))},{path:"/cart",name:"cart",component:()=>r.e(696).then(r.bind(r,8696))},{path:"/seller/addProduct",name:"add-product",component:()=>r.e(354).then(r.bind(r,7354))},{path:"/seller/editProduct/:productId",name:"edit-product",component:()=>r.e(461).then(r.bind(r,5461))},{path:"/seller/:shopId",name:"seller",component:()=>r.e(169).then(r.bind(r,3169))},{path:"/:pathMatch(.*)",name:"not-found",component:L}],ye=(0,I.p7)({history:(0,I.PO)(),linkExactActiveClass:"active",routes:be});ye.beforeEach(((e,t,r)=>{ge.dispatch("fetchCurrentUser"),r()}));var we=ye;(0,n.ri)(z).use(ge).use(ge).use(we).mount("#app")},6163:function(e,t,r){r.d(t,{F:function(){return u},l:function(){return c}});var n=r(6154),o=r(6455),a=r.n(o);const s="https://click-buy-backend-42e398391374.herokuapp.com/",c=n.Z.create({baseURL:s,timeout:5e3}),u=a().mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3})}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.m=e,function(){var e=[];r.O=function(t,n,o,a){if(!n){var s=1/0;for(l=0;l<e.length;l++){n=e[l][0],o=e[l][1],a=e[l][2];for(var c=!0,u=0;u<n.length;u++)(!1&a||s>=a)&&Object.keys(r.O).every((function(e){return r.O[e](n[u])}))?n.splice(u--,1):(c=!1,a<s&&(s=a));if(c){e.splice(l--,1);var i=o();void 0!==i&&(t=i)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[n,o,a]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,n){return r.f[n](e,t),t}),[]))}}(),function(){r.u=function(e){return"js/"+e+"."+{169:"e86a9f58",354:"0fccac93",461:"dc5d7749",462:"269cc2cf",696:"92bc32a1",931:"f4c31d90"}[e]+".js"}}(),function(){r.miniCssF=function(e){return"css/"+e+"."+{169:"299ef720",462:"35b8fa97",696:"a61ffe9c",931:"08b978e6"}[e]+".css"}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="click-buy-frontend:";r.l=function(n,o,a,s){if(e[n])e[n].push(o);else{var c,u;if(void 0!==a)for(var i=document.getElementsByTagName("script"),l=0;l<i.length;l++){var d=i[l];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+a){c=d;break}}c||(u=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,r.nc&&c.setAttribute("nonce",r.nc),c.setAttribute("data-webpack",t+a),c.src=n),e[n]=[o];var p=function(t,r){c.onerror=c.onload=null,clearTimeout(f);var o=e[n];if(delete e[n],c.parentNode&&c.parentNode.removeChild(c),o&&o.forEach((function(e){return e(r)})),t)return t(r)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=p.bind(null,c.onerror),c.onload=p.bind(null,c.onload),u&&document.head.appendChild(c)}}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){r.p="/click-buy-frontend/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,r,n,o){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css";var s=function(r){if(a.onerror=a.onload=null,"load"===r.type)n();else{var s=r&&("load"===r.type?"missing":r.type),c=r&&r.target&&r.target.href||t,u=new Error("Loading CSS chunk "+e+" failed.\n("+c+")");u.code="CSS_CHUNK_LOAD_FAILED",u.type=s,u.request=c,a.parentNode&&a.parentNode.removeChild(a),o(u)}};return a.onerror=a.onload=s,a.href=t,r?r.parentNode.insertBefore(a,r.nextSibling):document.head.appendChild(a),a},t=function(e,t){for(var r=document.getElementsByTagName("link"),n=0;n<r.length;n++){var o=r[n],a=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(a===e||a===t))return o}var s=document.getElementsByTagName("style");for(n=0;n<s.length;n++){o=s[n],a=o.getAttribute("data-href");if(a===e||a===t)return o}},n=function(n){return new Promise((function(o,a){var s=r.miniCssF(n),c=r.p+s;if(t(s,c))return o();e(n,c,null,o,a)}))},o={143:0};r.f.miniCss=function(e,t){var r={169:1,462:1,696:1,931:1};o[e]?t.push(o[e]):0!==o[e]&&r[e]&&t.push(o[e]=n(e).then((function(){o[e]=0}),(function(t){throw delete o[e],t})))}}}(),function(){var e={143:0};r.f.j=function(t,n){var o=r.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var a=new Promise((function(r,n){o=e[t]=[r,n]}));n.push(o[2]=a);var s=r.p+r.u(t),c=new Error,u=function(n){if(r.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var a=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;c.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",c.name="ChunkLoadError",c.type=a,c.request=s,o[1](c)}};r.l(s,u,"chunk-"+t,t)}},r.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,a,s=n[0],c=n[1],u=n[2],i=0;if(s.some((function(t){return 0!==e[t]}))){for(o in c)r.o(c,o)&&(r.m[o]=c[o]);if(u)var l=u(r)}for(t&&t(n);i<s.length;i++)a=s[i],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(l)},n=self["webpackChunkclick_buy_frontend"]=self["webpackChunkclick_buy_frontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(9046)}));n=r.O(n)})();
//# sourceMappingURL=app.74f956db.js.map